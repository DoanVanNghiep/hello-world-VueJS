{"ast":null,"code":"import axios from 'axios';\nconst API_URL = 'http://localhost:8081/';\nclass AuthService {\n  login(username, password) {\n    return axios.post(API_URL + 'authenticate', {\n      username,\n      password\n    }).then(response => {\n      if (response.data.token && response.data.user_id) {\n        // Kiểm tra nếu token và user_id có tồn tại\n        this.setCookie('user', JSON.stringify({\n          token: response.data.token,\n          user_id: response.data.user_id,\n          username: response.data.username,\n          role: response.data.role\n        }), 1); // Lưu vào cookie, hết hạn sau 1 ngày\n      }\n      return response.data;\n    });\n  }\n  signup(username, password, role) {\n    return axios.post(API_URL + 'signup', {\n      username,\n      password,\n      role\n    });\n  }\n  logout() {\n    const cartKey = this.getCartKey();\n    this.deleteCookie(cartKey); // Xóa giỏ hàng\n    this.deleteCookie('user'); // Xóa thông tin người dùng\n  }\n  getCurrentUser() {\n    const user = this.getCookie('user');\n    return user ? JSON.parse(user) : null;\n  }\n  getCurrentUserRole() {\n    const user = this.getCurrentUser();\n    return user ? user.role : null;\n  }\n  getCurrentUserId() {\n    const user = this.getCurrentUser();\n    return user ? user.user_id : null;\n  }\n  authHeader() {\n    const user = this.getCurrentUser();\n    if (user && user.token) {\n      return {\n        Authorization: 'Bearer ' + user.token\n      };\n    } else {\n      return {};\n    }\n  }\n  getCartKey() {\n    const user = this.getCurrentUser();\n    return user ? `cart_${user.user_id}` : 'cart';\n  }\n  saveCart(cart) {\n    const cartKey = this.getCartKey();\n    this.setCookie(cartKey, JSON.stringify(cart), 1); // Lưu giỏ hàng vào cookie, hết hạn sau 1 ngày\n  }\n  loadCart() {\n    const cartKey = this.getCartKey();\n    const cart = this.getCookie(cartKey);\n    return cart ? JSON.parse(cart) : [];\n  }\n\n  // Helper functions to manage cookies\n  setCookie(name, value, days) {\n    const date = new Date();\n    date.setTime(date.getTime() + days * 24 * 60 * 60 * 1000);\n    const expires = \"expires=\" + date.toUTCString();\n    document.cookie = name + \"=\" + value + \";\" + expires + \";path=/\";\n  }\n  getCookie(name) {\n    const nameEQ = name + \"=\";\n    const ca = document.cookie.split(';');\n    for (let i = 0; i < ca.length; i++) {\n      let c = ca[i];\n      while (c.charAt(0) === ' ') c = c.substring(1, c.length);\n      if (c.indexOf(nameEQ) === 0) return c.substring(nameEQ.length, c.length);\n    }\n    return null;\n  }\n  deleteCookie(name) {\n    document.cookie = name + '=; Max-Age=-99999999;';\n  }\n}\nexport default new AuthService();","map":{"version":3,"names":["axios","API_URL","AuthService","login","username","password","post","then","response","data","token","user_id","setCookie","JSON","stringify","role","signup","logout","cartKey","getCartKey","deleteCookie","getCurrentUser","user","getCookie","parse","getCurrentUserRole","getCurrentUserId","authHeader","Authorization","saveCart","cart","loadCart","name","value","days","date","Date","setTime","getTime","expires","toUTCString","document","cookie","nameEQ","ca","split","i","length","c","charAt","substring","indexOf"],"sources":["E:/VueJS/hello-world/src/service/AuthService.js"],"sourcesContent":["import axios from 'axios';\r\n\r\nconst API_URL = 'http://localhost:8081/';\r\n\r\nclass AuthService {\r\n    login(username, password) {\r\n        return axios\r\n            .post(API_URL + 'authenticate', {\r\n                username,\r\n                password\r\n            })\r\n            .then(response => {\r\n                if (response.data.token && response.data.user_id) { // Kiểm tra nếu token và user_id có tồn tại\r\n                    this.setCookie('user', JSON.stringify({\r\n                        token: response.data.token,\r\n                        user_id: response.data.user_id,\r\n                        username: response.data.username,\r\n                        role: response.data.role\r\n                    }), 1); // Lưu vào cookie, hết hạn sau 1 ngày\r\n                }\r\n                return response.data;\r\n            });\r\n    }\r\n\r\n    signup(username, password, role) {\r\n        return axios.post(API_URL + 'signup', {\r\n            username,\r\n            password,\r\n            role\r\n        });\r\n    }\r\n\r\n    logout() {\r\n        const cartKey = this.getCartKey();\r\n        this.deleteCookie(cartKey); // Xóa giỏ hàng\r\n        this.deleteCookie('user'); // Xóa thông tin người dùng\r\n    }\r\n\r\n    getCurrentUser() {\r\n        const user = this.getCookie('user');\r\n        return user ? JSON.parse(user) : null;\r\n    }\r\n\r\n    getCurrentUserRole() {\r\n        const user = this.getCurrentUser();\r\n        return user ? user.role : null;\r\n    }\r\n\r\n    getCurrentUserId() {\r\n        const user = this.getCurrentUser();\r\n        return user ? user.user_id : null;\r\n    }\r\n\r\n    authHeader() {\r\n        const user = this.getCurrentUser();\r\n        if (user && user.token) {\r\n            return { Authorization: 'Bearer ' + user.token };\r\n        } else {\r\n            return {};\r\n        }\r\n    }\r\n\r\n    getCartKey() {\r\n        const user = this.getCurrentUser();\r\n        return user ? `cart_${user.user_id}` : 'cart';\r\n    }\r\n\r\n    saveCart(cart) {\r\n        const cartKey = this.getCartKey();\r\n        this.setCookie(cartKey, JSON.stringify(cart), 1); // Lưu giỏ hàng vào cookie, hết hạn sau 1 ngày\r\n    }\r\n\r\n    loadCart() {\r\n        const cartKey = this.getCartKey();\r\n        const cart = this.getCookie(cartKey);\r\n        return cart ? JSON.parse(cart) : [];\r\n    }\r\n\r\n    // Helper functions to manage cookies\r\n    setCookie(name, value, days) {\r\n        const date = new Date();\r\n        date.setTime(date.getTime() + (days * 24 * 60 * 60 * 1000));\r\n        const expires = \"expires=\" + date.toUTCString();\r\n        document.cookie = name + \"=\" + value + \";\" + expires + \";path=/\";\r\n    }\r\n\r\n    getCookie(name) {\r\n        const nameEQ = name + \"=\";\r\n        const ca = document.cookie.split(';');\r\n        for(let i = 0; i < ca.length; i++) {\r\n            let c = ca[i];\r\n            while (c.charAt(0) === ' ') c = c.substring(1, c.length);\r\n            if (c.indexOf(nameEQ) === 0) return c.substring(nameEQ.length, c.length);\r\n        }\r\n        return null;\r\n    }\r\n\r\n    deleteCookie(name) {\r\n        document.cookie = name + '=; Max-Age=-99999999;';\r\n    }\r\n}\r\n\r\nexport default new AuthService();"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}